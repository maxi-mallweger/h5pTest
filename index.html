<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>H5P Interactive Book</title>
    <script type="text/javascript" src="assets/main.bundle.js"></script>
  </head>
  <body>
    <div id="h5p-container"></div>

    <script>
      const el = document.getElementById("h5p-container");
      const options = {
        h5pJsonPath: "h5p-folder/", // The H5P content folder
        frameJs: "assets/frame.bundle.js", // Path to H5P frame JS
        frameCss: "assets/styles/h5p.css", // Path to H5P frame CSS
      };

      // Fix the paths to images and other assets manually
      const baseUrl = "https://maxi-mallweger.github.io/h5pTest/"; // Replace YOUR_REPO_NAME with your actual repo name

      // Function to rewrite paths
      const rewritePaths = (data) => {
        // Rewrite the JSON paths for content, images, and other assets
        if (data && data.assets) {
          data.assets.forEach((asset) => {
            // If the asset is an image or library, rewrite the path
            if (asset.path) {
              asset.path = baseUrl + asset.path.replace(/^\/+/, ""); // Fix leading slashes and add base URL
            }
          });
        }
      };

      // Load the H5P content and apply the path fix
      fetch(options.h5pJsonPath + "h5p.json")
        .then((response) => response.json())
        .then((data) => {
          // Apply path fixes
          rewritePaths(data);

          // Initialize the H5P content with the fixed data
          new H5PStandalone.H5P(el, options);
        })
        .catch((error) => console.error("Error loading H5P content:", error));
    </script>
  </body>
</html>
